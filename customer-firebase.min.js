import{initializeApp}from"https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";import{getFirestore,collection,addDoc,getDocs,query,orderBy}from"https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";const firebaseConfig={apiKey:"AIzaSyCT1Zb6b9qBDxa2nrqNu_6cSJ6jCKfq4yY",authDomain:"niapay-carwash.firebaseapp.com",projectId:"niapay-carwash",storageBucket:"niapay-carwash.firebasestorage.app",messagingSenderId:"994223696529",appId:"1:994223696529:web:97e8e7807cc7338878ed30",measurementId:"G-NKDCNQZND5"},app=initializeApp(firebaseConfig),db=getFirestore(app);function generateCustomerId(e){const o=e.replace(/\s+/g,"").toUpperCase(),r=Math.random().toString(36).substring(2,8).toUpperCase();return`${o}_${Date.now()}_${r}`}export async function saveJob(e){try{e.createdAt=(new Date).toISOString(),e.status="Pending",e.customerId=generateCustomerId(e.plate),e.jobUUID=crypto.randomUUID();const o=await addDoc(collection(db,"customer"),e);return console.log("✅ Job saved with Firestore ID:",o.id),console.log("✅ Job customerId:",e.customerId),console.log("✅ Job UUID:",e.jobUUID),{firestoreId:o.id,customerId:e.customerId,jobUUID:e.jobUUID}}catch(e){return console.error("❌ Error adding job:",e),null}}export async function loadPendingJobs(){try{const e=query(collection(db,"customer"),orderBy("createdAt","desc")),o=await getDocs(e),r=[];return o.forEach(e=>{const o={firestoreId:e.id,...e.data()};"Pending"!==o.status&&"In Progress"!==o.status||r.push(o)}),console.log(`✅ Loaded ${r.length} jobs`),r}catch(e){return console.error("❌ Error loading jobs:",e),[]}}