import{initializeApp}from"https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";import{getAuth,createUserWithEmailAndPassword,signInWithEmailAndPassword}from"https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";import{getFirestore,doc,setDoc,getDoc}from"https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";import{getAnalytics}from"https://www.gstatic.com/firebasejs/12.3.0/firebase-analytics.js";const firebaseConfig={apiKey:"AIzaSyCT1Zb6b9qBDxa2nrqNu_6cSJ6jCKfq4yY",authDomain:"niapay-carwash.firebaseapp.com",projectId:"niapay-carwash",storageBucket:"niapay-carwash.appspot.com",messagingSenderId:"994223696529",appId:"1:994223696529:web:97e8e7807cc7338878ed30",measurementId:"G-NKDCNQZND5"},app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app);async function signUpUser(e,t,a,o,s){if(a===o)try{const o=(await createUserWithEmailAndPassword(auth,t,a)).user;await setDoc(doc(db,"users",o.uid),{uid:o.uid,name:e,email:t,role:s,createdAt:(new Date).toISOString()}),showPopup("Account created successfully!","success"),setTimeout(()=>{window.location.href="manager"===s?"manager.html":"staff.html"},1500)}catch(e){console.error("SignUp Error:",e),showPopup(e.message,"error")}else showPopup("Passwords do not match.","error")}async function signInUser(e,t,a,o){try{const e=(await signInWithEmailAndPassword(auth,t,a)).user,s=await getDoc(doc(db,"users",e.uid));if(s.exists()){const e=s.data();if(e.role!==o)return void showPopup("Role mismatch! Check your login role.","error");showPopup(`Welcome back, ${e.name}!`,"success"),setTimeout(()=>{"manager"===e.role?window.location.href="manager.html":window.location.href="staff.html"},1500)}else showPopup("User data not found in database.","error")}catch(e){console.error("Login Error:",e),showPopup(e.message,"error")}}function showPopup(e,t){const a=document.createElement("div");a.className=`popup ${t}`,a.textContent=e,document.body.appendChild(a),setTimeout(()=>a.remove(),3e3)}getAnalytics(app),document.getElementById("signupForm").addEventListener("submit",e=>{e.preventDefault();signUpUser(document.getElementById("signupName").value.trim(),document.getElementById("signupEmail").value.trim(),document.getElementById("signupPassword").value.trim(),document.getElementById("signupConfirm").value.trim(),document.getElementById("signupRole").value)}),document.getElementById("loginForm").addEventListener("submit",e=>{e.preventDefault();signInUser(document.getElementById("loginName").value.trim(),document.getElementById("loginEmail").value.trim(),document.getElementById("loginPassword").value.trim(),document.getElementById("loginRole").value)});export{auth,db};